import os.path
import random


def mask_binary(binary, percentage_to_mask, output_dir):
    with open(binary, 'rb') as infile:
        content = infile.read()
        content = bytearray(content)
    bytes_to_mask_num = len(content) * percentage_to_mask
    bytes_to_mask_num = int(bytes_to_mask_num)
    byte_indices = [n for n in range(len(content))]
    bytes_to_mask_indices = random.sample(byte_indices, bytes_to_mask_num)

    for byte_index in bytes_to_mask_indices:
        content[byte_index] = 0

    with open(os.path.join(output_dir, os.path.basename(binary)), 'wb') as outfile:
        outfile.write(bytes(content))
