import logging

from keras.callbacks import Callback


class ValidationCallback(Callback):
    def __init__(self, validation_name, validation_iterator):
        super(ValidationCallback, self).__init__()
        self.validation_name = validation_name
        self.validation_iterator = validation_iterator
        self.epoch_counter = 1

    def on_test_end(self, logs=None):
        history = self.model.evaluate(self.validation_iterator)
        logging.info(f"At epoch{self.epoch_counter}, {self.validation_name} loss/accuracy: {history}")
        self.epoch_counter += 1
