from keras import Model

from detectors.utils import get_model


def make_classifier_only_model(model_name, model_path):
    full_model = get_model(model_name, model_path)
    if "malconv" in model_name:
        return Model(inputs=full_model.layers[-3].output, outputs=full_model.layers[-1].output)
    elif "avastnet" in model_name :
        return Model(inputs=full_model.layers[-8].output, outputs=full_model.layers[-1].output)
    else:
        raise NameError(f"{model_name} not found")
